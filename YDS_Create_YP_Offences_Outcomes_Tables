  YDS_Raw <-read.csv("YOT_Pentaho_Extract.csv") # writes CSV extracted from Pentaho into a dataframe
  YDS_Raw <- filter(YDS_Raw,residenceonlegaloutcomedate=="Local"|residenceonlegaloutcomedate=="") #filters out other residence
  YDS_Raw <- filter(YDS_Raw,!legal_outcome_group_fixed %in% c("Unknown",""))
  YDS_Raw <-filter(YDS_Raw,!outcomeappealstatus %in% c("Changed on appeal","Result of appeal successful"))
  YDS_Raw$yot_name<-as.character(YDS_Raw$yot_name) #Convert YOT_name field data type to character
  YDS_Raw$oypid<-as.character(YDS_Raw$oypid)
  YDS_Raw$YPID2<-paste(YDS_Raw$yot_name,YDS_Raw$currentyotid,sep="") #create new field
  YDS_Raw$YPID2 <- ifelse(YDS_Raw$yot_name == "Buckinghamshire"|YDS_Raw$yot_name == "Croydon"|YDS_Raw$yot_name == "Southampton", paste(YDS_Raw$yot_name,YDS_Raw$oypid,sep=""),YDS_Raw$YPID2)
  YP<-YDS_Raw[c(1,2,31,5,7,8)]
  YP<-distinct(YP)
  YP$gender <- replace(as.character(YP$gender), YP$gender == "Female", "F")
  YP$gender <- replace(as.character(YP$gender), YP$gender == "Male", "M")
  YP$gender <- replace(as.character(YP$gender), YP$gender == 0, "Unknown")
  YP$gender <- replace(as.character(YP$gender), YP$gender == 9, "Unknown")
  YP$ethnicitygroup <- replace(as.character(YP$ethnicitygroup), YP$ethnicitygroup == "Black or Black British", "Black")
  YP$ethnicitygroup <- replace(as.character(YP$ethnicitygroup), YP$ethnicitygroup == "Asian or Asian British", "Asian")
  YP$ethnicitygroup <- replace(as.character(YP$ethnicitygroup), YP$ethnicitygroup == "Chinese or Other Ethnic Group", "Other")
  YP$ethnicitygroup <- replace(as.character(YP$ethnicitygroup), YP$ethnicitygroup == "Unknown Ethnicity", "Unknown")
  YP_Eth<-table(YP$yot_name,YP$ethnicitygroup)
  YP_Eth<-as.data.frame.matrix(YP_Eth)
  YP_Gen<-table(YP$yot_name,YP$gender)
  YP_Gen<-as.data.frame.matrix(YP_Gen)
  Offence<-YDS_Raw[c(1,2,3,12,13,14,15)]
  Offence<-distinct(Offence)
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "ARSON","Arson")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "BREACH_OF_BAIL","Breach of bail")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "BREACH_OF_CONDITIONAL_DISCHARGE","Breach of conditional discharge")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "BREACH_OF_STATUTORY_ORDER","Breach of statutory order")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "CRIMINAL_DAMAGE","Criminal damage")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "DEATH_OR_INJURY_BY_DANGEROUS_DRIVING","Death or injury by dangerous driving")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "DOMESTIC_BURGLARY","Domestic burglary")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "DRUGS","Drugs")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "FRAUD_AND_FORGERY","Fraud and forgery")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "MOTORING_OFFENCES","Motoring offences")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "NON_DOMESTIC_BURGLARY","Non domestic burglary")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "NOT_KNOWN","Not known")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "OTHER","Other")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "PUBLIC_ORDER","Public order")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "RACIALLY_AGGRAVATED","Racially aggravated")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "ROBBERY","Robbery")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "SEXUAL_OFFENCES","Sexual offences")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "THEFT_AND_HANDLING_STOLEN_GOODS","Theft and handling stolen goods")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "VEHICLE_THEFT_UNAUTHORISED_TAKING","Vehicle theft / unauthorised taking")
  Offence$yjboffencecategory <- replace(as.character(Offence$yjboffencecategory), Offence$yjboffencecategory == "VIOLENCE_AGAINST_THE_PERSON","Violence against the person")
  Outcome<-YDS_Raw[c(1,2,16,22,24,25)]
  Outcome<-distinct(Outcome)
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "ABSOLUTE_DISCHARGE","Absolute Discharge")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "ADJOURNED_SINE_DIE","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "ATTENDANCE_CENTRE_ORDER","Youth Rehabilitation Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "AWAITING_PROPOSAL","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "COMMUNITY_REHABILITATION_ORDER","Youth Rehabilitation Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "COMMUNITY_REHABILITATION_ORDER_AND_CONDITIONS","Youth Rehabilitation Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "COMMUNITY_RESOLUTION","Youth Rehabilitation Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "COMPENSATION_ORDER","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "CONDITIONAL_DISCHARGE","Conditional Discharge")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "DETENTION_AND_TRAINING_ORDER","Detention and Training Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "DISCHARGED","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "DISCONTINUED","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "DISMISSED","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "FINE","Fine")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "LIE_ON_FILE","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "NO_FURTHER_ACTION","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "NO_SEPARATE_PENALTY","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "NOT_GUILTY","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "NOT_KNOWN","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "NOT_PROVED","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "ORDER_REVOKED","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "ORDER_TO_CONTINUE","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "OTHER","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "REFERRAL_ORDER","Referral Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "REFERRAL_ORDER_EXTENSION","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "REPARATION_ORDER","Reparation Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SECTION_226_B","Section 226b")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SECTION_226_LIFE","Section 226b")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SECTION_226_PUBLIC_PROTECTION","Section 226b")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SECTION_228","Section 226b")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SECTION_90_92_DETENTION","Section 90-91 Detention")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SENTENCE_DEFERRED","Sentence Deferred")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "SUPERVISION_ORDER","Youth Rehabilitation Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "TAKEN_INTO_CONSIDERATION","Other")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "YOUNG_OFFENDER_INSTITUTION","Detention and Training Order")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "YOUTH_CAUTION","Youth Caution")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "YOUTH_CONDITIONAL_CAUTION","Youth Conditional Caution")
  Outcome$legal_outcome_fixed <- replace(as.character(Outcome$legal_outcome_fixed), Outcome$legal_outcome_fixed == "YOUTH_REHABILITATION_ORDER","Youth Rehabilitation Order")
  Custody<-filter(Outcome,legal_outcome_group_fixed=="Custody")
